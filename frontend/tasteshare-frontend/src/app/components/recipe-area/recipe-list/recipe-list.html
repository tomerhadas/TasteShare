<div class="recipes-container">
  <div class="page-header">
    <h1>Discover Amazing Recipes</h1>
    <p class="subtitle">Find the perfect recipe for your next meal</p>
  </div>

  <!-- Search + Filter -->
  <div class="filters-section">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Search recipe</mat-label>
      <input
        matInput
        [(ngModel)]="searchTerm"
        placeholder="Search by name or ingredient"
      />
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>

    <div class="filter-controls">
      <mat-form-field appearance="outline">
        <mat-label>Difficulty</mat-label>
        <mat-select [(ngModel)]="selectedDifficulty">
          <mat-option [value]="null">All</mat-option>
          <mat-option [value]="0">Easy</mat-option>
          <mat-option [value]="1">Medium</mat-option>
          <mat-option [value]="2">Hard</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Food type</mat-label>
        <mat-select [(ngModel)]="selectedFoodType">
          <mat-option [value]="null">All</mat-option>
          <mat-option [value]="0">Meat</mat-option>
          <mat-option [value]="1">Dairy</mat-option>
          <mat-option [value]="2">Parve</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <!-- Loading -->
  @if (loading) {
  <div class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Loading recipes...</p>
  </div>
  }

  <!-- Error -->
  @if (errorMessage) {
  <div class="error-container">
    <mat-icon color="warn">error</mat-icon>
    <p>{{ errorMessage }}</p>
  </div>
  }

  <!-- Recipe Grid -->
  @if (!loading && recipes.length > 0) {
  <div class="recipe-grid">
    <mat-card class="recipe-card" *ngFor="let recipe of recipes">
      <!-- image / placeholder -->
      @if (recipe.images && recipe.images.length) {
      <img mat-card-image [src]="recipe.images[0].url" [alt]="recipe.title" />
      } @else {
      <div class="no-image">
        <mat-icon>no_photography</mat-icon>
      </div>
      }

      <mat-card-content>
        <div class="card-header">
          <mat-chip-set>
            <!-- Food type chip (colored) -->
            <mat-chip
              [ngClass]="recipe.foodType === 0 ? 'chip-meat'
                           : recipe.foodType === 1 ? 'chip-dairy'
                           : 'chip-parve'"
            >
              {{ recipe.foodType === 0 ? 'Meat' : recipe.foodType === 1 ?
              'Dairy' : 'Parve' }}
            </mat-chip>

            <!-- Difficulty chip (colored) -->
            <mat-chip
              [ngClass]="recipe.difficulty === 0 ? 'chip-easy'
                           : recipe.difficulty === 1 ? 'chip-medium'
                           : 'chip-hard'"
            >
              {{ recipe.difficulty === 0 ? 'Easy' : recipe.difficulty === 1 ?
              'Medium' : 'Hard' }}
            </mat-chip>
          </mat-chip-set>
        </div>

        <h2 class="recipe-title">{{ recipe.title }}</h2>
        <p class="recipe-description">{{ recipe.description }}</p>

        <div class="recipe-meta">
          <div class="meta-item">
            <mat-icon>access_time</mat-icon>
            <span>{{ recipe.prepMinutes + recipe.cookMinutes }} min</span>
          </div>
          <div class="meta-item">
            <mat-icon>restaurant</mat-icon>
            <span>{{ recipe.servings }} servings</span>
          </div>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button
          mat-button
          color="primary"
          [routerLink]="['/recipes', recipe.id]"
        >
          <mat-icon>visibility</mat-icon>
          View Recipe
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
  }

  <!-- No Results -->
  @if (!loading && recipes.length === 0) {
  <div class="no-results">
    <mat-icon>search_off</mat-icon>
    <h3>No recipes found</h3>
    <p>Try adjusting your search or filters</p>
  </div>
  }
</div>
