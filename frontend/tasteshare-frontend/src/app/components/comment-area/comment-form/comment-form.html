<div class="comment-form-container">
  <h3 class="comments-heading">Add a Comment</h3>

  @if (isAuthenticated) {
  <div class="comment-form-inner">
    @if (user) {
    <div class="user-info">
      <mat-icon class="user-avatar">account_circle</mat-icon>
      <span class="username">{{ user.username }}</span>
    </div>
    }

    <mat-form-field appearance="outline" class="comment-input">
      <mat-label>Your Comment</mat-label>
      <textarea
        matInput
        [(ngModel)]="commentText"
        placeholder="Share your thoughts about this recipe..."
        rows="3"
        [disabled]="submitting"
      ></textarea>
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      (click)="submitComment()"
      [disabled]="!commentText.trim() || submitting"
      class="submit-button"
    >
      <mat-icon>send</mat-icon>
      Post Comment
    </button>

    @if (submitting) {
    <div class="spinner-container">
      <mat-spinner diameter="24"></mat-spinner>
    </div>
    }
  </div>
  } @else {
  <div class="login-prompt">
    <p>You need to log in to post a comment.</p>
    <button mat-raised-button color="primary" routerLink="/login">Login</button>
  </div>
  }
</div>
